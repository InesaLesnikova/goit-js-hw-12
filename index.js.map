{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function searchImage(request, page = 1, per_page = 20) {\n  const API_KEY = '49253518-6fbcd3e4502fdc6eae88c44f3';\n  const URL =\n    'https://pixabay.com/api/?key=' +\n    API_KEY +\n    '&q=' +\n    encodeURIComponent(request) +\n    '&image_type=photo' +\n    '&orientation=horizontal' +\n    '&safesearch=true' +\n    '&page=' +\n    page +\n    '&per_page=' +\n    per_page;\n\n  if (!request.trim()) {\n    return Promise.reject(new Error('Please enter something!'));\n  }\n\n  try {\n    const result = await axios.get(URL);\n    if (result.data.hits.length === 0) {\n      return Promise.reject(\n        new Error('Sorry, no images match your search query. Try again!')\n      );\n    }\n\n    return { urls: result.data.hits, total: result.data.totalHits };\n  } catch {\n    return Promise.reject(new Error('An error occurred while fetching images. Try again later!'));\n  }\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet gallery = new SimpleLightbox('.gallery a');\n\nexport function renderGallary(images, galleryHTML) {\n  let markup = images\n    .map(\n      image => `\n      <li>\n        <a href=\"${image.largeImageURL}\"><img src=\"${image.webformatURL}\" alt=\"${image.tags}\" width=\"360\" height=\"200\" /></a>\n        <table class=\"caption\">\n          <thead>\n            <tr>\n              <th>Likes</th>\n              <th>Views</th>\n              <th>Comments</th>\n              <th>Downloads</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr>\n              <td>${image.likes}</td>\n              <td>${image.views}</td>\n              <td>${image.comments}</td>\n              <td>${image.downloads}</td>\n            </tr>\n          </tbody>\n        </table>\n      </li>`\n    )\n    .join('');\n\n  // const galleryOption = {\n  //   captionSelector: 'img',\n  //   captionType: 'attr',\n  //   captionsData: 'alt',\n  //   captionDelay: 250,\n  // };\n  galleryHTML.insertAdjacentHTML('beforeend', markup);\n\n  // const imgLd = galleryHTML.querySelectorAll('img');\n  // console.log(' renderGallary imgLd:', imgLd);\n\n  // const imgLdP = [...imgLd].map(img => {\n  //   return new Promise((resolve, reject) => {\n  //     img.onload = () => resolve(img);\n  //     if (0) {\n  //       reject();\n  //     }\n  //   });\n  // });\n  // console.log(' renderGallary imgLdP:', imgLdP);\n\n  // Promise.all(imgLdP).then();\n\n  gallery.refresh();\n\n  //   gallery.on('show.simplelightbox', function () {\n  //     // Do somethingâ€¦\n  //   });\n\n  // gallery.on('error.simplelightbox', function (e) {\n  //   console.log(e); // Some usefull information\n  // });\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { searchImage } from './js/pixabay-api';\nimport { renderGallary } from './js/render-functions';\n\nconst refs = {\n  form: document.querySelector('.form'),\n  gallery: document.querySelector('.gallery'),\n  loader: document.querySelector('.loading'),\n  moreImgBtn: document.getElementById('moreImgBtn'),\n  request: document.querySelector('.form input'),\n  submitBtn: document.querySelector('.form button'),\n};\n\nrefs.form.addEventListener('submit', handleSubmitClick);\nrefs.moreImgBtn.addEventListener('click', handleMoreClick);\n\nlet page = 1;\nconst per_page = 20;\nlet request = '';\n\nasync function handleSubmitClick(event) {\n  event.preventDefault();\n  request = refs.request.value.trim();\n\n  if (!request) {\n    iziToast.error({\n      position: 'topRight',\n      message: 'Please enter a valid search query.',\n    });\n    return;\n  }\n\n  refs.request.setAttribute('readonly', true);\n  refs.submitBtn.disabled = true;\n  refs.loader.classList.remove('hidden');\n\n  page = 1;\n  try {\n    const images = await searchImage(request, page, per_page);\n    refs.loader.classList.add('hidden');\n    refs.request.removeAttribute('readonly');\n    refs.submitBtn.disabled = false;\n\n    if (!images || !images.urls || images.urls.length === 0) {\n      refs.gallery.innerHTML = '';\n      refs.moreImgBtn.classList.add('hidden');\n      iziToast.warning({\n        position: 'topRight',\n        message: 'No images found. Please try a different search query.',\n      });\n      return;\n    }\n\n    refs.gallery.innerHTML = '';\n    refs.request.value = '';\n    renderGallary(images.urls, refs.gallery);\n    needMoreBtnCheck(images);\n  } catch (error) {\n    refs.loader.classList.add('hidden');\n    refs.request.removeAttribute('readonly');\n    refs.submitBtn.disabled = false;\n    iziToast.error({\n      position: 'topRight',\n      message: 'An error occurred while fetching images. Please try again later.',\n    });\n  }\n}\n\nasync function handleMoreClick() {\n  refs.loader.classList.remove('hidden');\n\n  try {\n    const images = await searchImage(request, ++page, per_page);\n    refs.loader.classList.add('hidden');\n\n    if (!images || !images.urls || images.urls.length === 0) {\n      refs.moreImgBtn.classList.add('hidden');\n      iziToast.info({\n        position: 'topRight',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n      return;\n    }\n\n    const lastGalleryCard = refs.gallery.lastElementChild;\n    renderGallary(images.urls, refs.gallery);\n    needMoreBtnCheck(images);\n\n    if (lastGalleryCard) {\n      const { top: lastCardPos } = lastGalleryCard.getBoundingClientRect();\n      window.scrollBy({ top: lastCardPos - 24, behavior: 'smooth' });\n    }\n  } catch (error) {\n    refs.loader.classList.add('hidden');\n    iziToast.error({\n      position: 'topRight',\n      message: 'An error occurred while fetching more images. Please try again later.',\n    });\n  }\n}\n\nfunction needMoreBtnCheck(images) {\n  if (!images || images.urls.length < per_page || images.total === page * per_page) {\n    refs.moreImgBtn.classList.add('hidden');\n    refs.moreImgBtn.removeEventListener('click', handleMoreClick);\n    iziToast.info({\n      position: 'topRight',\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n  } else {\n    refs.moreImgBtn.classList.remove('hidden');\n    refs.moreImgBtn.addEventListener('click', handleMoreClick);\n  }\n}\n"],"names":["searchImage","request","page","per_page","URL","result","axios","gallery","SimpleLightbox","renderGallary","images","galleryHTML","markup","image","refs","handleSubmitClick","handleMoreClick","event","iziToast","needMoreBtnCheck","lastGalleryCard","lastCardPos"],"mappings":"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"}